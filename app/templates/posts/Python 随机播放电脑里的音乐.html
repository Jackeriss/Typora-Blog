{% extends "../base.html" %}{% block description %}Python 随机播放电脑里的音乐{% end %}{% block title %}Python 随机播放电脑里的音乐{% end %}{% block section %}<div class="postBlock"><body class="typora-export">
<div class="is-mac" id="write"><h2><a class="md-header-anchor " name="header-c5"></a>Python 随机播放电脑里的音乐</h2><div class="time">                                               <input type="hidden" value="{{                                                timestamp }}"/></div><p>给大家分享一个用 Python 搜索遍历磁盘中的文件的方法，以 Windows 下随机播放磁盘中的音乐为例。</p><pre class="md-fences md-end-block" lang="python"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-hscrollbar" style="left: 0px; min-height: 18px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># -*- coding: utf-8 -*-</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">os</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">random</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">disks</span> = [<span class="cm-string">'D'</span>, <span class="cm-string">'E'</span>, <span class="cm-string">'F'</span>, <span class="cm-string">'G'</span>, <span class="cm-string">'H'</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">search_file</span>(<span class="cm-variable">filename</span>, <span class="cm-variable">search_path</span>, <span class="cm-variable">pathsep</span>=<span class="cm-variable">os</span>.<span class="cm-property">pathsep</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">path</span> <span class="cm-keyword">in</span> <span class="cm-variable">search_path</span>.<span class="cm-property">split</span>(<span class="cm-variable">pathsep</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-variable">candidate</span> = <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">path</span>, <span class="cm-variable">filename</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">isfile</span>(<span class="cm-variable">candidate</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">return</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">abspath</span>(<span class="cm-variable">candidate</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">random_play</span>():  </span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">music</span> = []</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">found</span> = <span class="cm-builtin">False</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">for</span> <span class="cm-variable">disk</span> <span class="cm-keyword">in</span> <span class="cm-variable">disks</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">dirpath</span>, <span class="cm-variable">dirnames</span>, <span class="cm-variable">filenames</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-property">walk</span>(<span class="cm-variable">disk</span> <span class="cm-operator">+</span> <span class="cm-string">':/'</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">filename</span> <span class="cm-keyword">in</span> <span class="cm-variable">filenames</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">splitext</span>(<span class="cm-variable">filename</span>)[<span class="cm-number">1</span>] == <span class="cm-string">'.mp3'</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-variable">filepath</span> = <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">dirpath</span>, <span class="cm-variable">filename</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-comment"># 这里是为了防止打开一些体积较小的音频，比如游戏配音</span></span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">getsize</span>(<span class="cm-variable">filepath</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">1048576</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">music</span>.<span class="cm-property">append</span>(<span class="cm-variable">filepath</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">found</span> = <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">found</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">dirpath</span>, <span class="cm-variable">dirnames</span>, <span class="cm-variable">filenames</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-property">walk</span>(<span class="cm-string">'C:/Users'</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">filename</span> <span class="cm-keyword">in</span> <span class="cm-variable">filenames</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">splitext</span>(<span class="cm-variable">filename</span>)[<span class="cm-number">1</span>] == <span class="cm-string">'.mp3'</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-variable">filepath</span> = <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">dirpath</span>, <span class="cm-variable">filename</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">getsize</span>(<span class="cm-variable">filepath</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">1048576</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">music</span>.<span class="cm-property">append</span>(<span class="cm-variable">filepath</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">found</span> = <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">found</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">disk</span> <span class="cm-keyword">in</span> <span class="cm-variable">disks</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">dirpath</span>, <span class="cm-variable">dirnames</span>, <span class="cm-variable">filenames</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-property">walk</span>(<span class="cm-variable">disk</span><span class="cm-operator">+</span><span class="cm-string">':/'</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">for</span> <span class="cm-variable">filename</span> <span class="cm-keyword">in</span> <span class="cm-variable">filenames</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">splitext</span>(<span class="cm-variable">filename</span>)[<span class="cm-number">1</span>] == <span class="cm-string">'.wma'</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">filepath</span> = <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">dirpath</span>, <span class="cm-variable">filename</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">getsize</span>(<span class="cm-variable">filepath</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">1048576</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                            <span class="cm-variable">music</span>.<span class="cm-property">append</span>(<span class="cm-variable">filepath</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                            <span class="cm-variable">found</span> = <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">found</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">for</span> <span class="cm-variable">dirpath</span>, <span class="cm-variable">dirnames</span>, <span class="cm-variable">filenames</span> <span class="cm-keyword">in</span> <span class="cm-variable">os</span>.<span class="cm-property">walk</span>(<span class="cm-string">'C:/Users'</span>):</span></pre><pre class=""><span style="padding-right: 0.1px;">            <span class="cm-keyword">for</span> <span class="cm-variable">filename</span> <span class="cm-keyword">in</span> <span class="cm-variable">filenames</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">splitext</span>(<span class="cm-variable">filename</span>)[<span class="cm-number">1</span>] == <span class="cm-string">'.wma'</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-variable">filepath</span> = <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">join</span>(<span class="cm-variable">dirpath</span>, <span class="cm-variable">filename</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                    <span class="cm-keyword">if</span> <span class="cm-variable">os</span>.<span class="cm-property">path</span>.<span class="cm-property">getsize</span>(<span class="cm-variable">filepath</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">1048576</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">music</span>.<span class="cm-property">append</span>(<span class="cm-variable">filepath</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">                        <span class="cm-variable">found</span> = <span class="cm-builtin">True</span></span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">random_music</span> = <span class="cm-variable">random</span>.<span class="cm-property">choice</span>(<span class="cm-variable">music</span>)</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">os</span>.<span class="cm-property">startfile</span>(<span class="cm-variable">random_music</span>)  </span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-keyword">if</span> <span class="cm-keyword">not</span> <span class="cm-variable">found</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">        <span class="cm-keyword">print</span><span class="cm-string">'没有找到音频文件'</span></span></pre><pre class=""><span style="padding-right: 0.1px;">        </span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-variable">__name__</span> == <span class="cm-string">'__main__'</span>:</span></pre><pre class=""><span style="padding-right: 0.1px;">    <span class="cm-variable">random_play</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1276px;"></div></div></div></pre><p>本方法的实现参考了《Python Cookbook》，只用了 Python 的 os 模块。</p></div>
</body><div id="comments"><p>评论功能暂时关闭！</p></div>{% end %}